<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta content="width=device-width, initial-scale=1.0" name="viewport" />

	<link href="img/logo.jpeg" rel="icon" type="image/jpeg" />
	<title>Games</title>

	<!--	<link href="css/main.css" rel="stylesheet" />-->
</head>
<body>

<div>
	<table>
		<thead>
		<tr>
			<th>Game Name</th>
			<th>Owner</th>
			<th>Players</th>
			<th>Join</th>
		</tr>
		</thead>
		<tbody id="games">
		</tbody>
	</table>
</div>

<div>
	<button id="refresh">Refresh</button>
</div>

<div>
	<a class="mainButton" href="/" id="back">Back</a>
</div>

</body>
<script>
	const gamesList = document.getElementById('games');

	function addGame(game) {
		const tr = document.createElement('tr');
		tr.innerHTML = `
			<td>${game.name}</td>
			<td>${game.owner.name}</td>
			<td>${game.players.length}</td>
			<td><a href="/play?game=${game.id}">Join</a></td>
		`;
		gamesList.appendChild(tr);
	}

	function refreshGames() {
		fetch('/api/games')
			.then(response => response.json())
			.then(data => {
				gamesList.innerHTML = '';
				data.forEach(addGame);
			});
	}

	refreshGames();

	document.getElementById('refresh').addEventListener('click', refreshGames);
</script>
</html>
